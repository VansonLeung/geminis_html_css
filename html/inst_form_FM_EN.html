<style type="text/css">.redbartop{
        width: 100%; height: 10px;  background-color: #bc0000;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
    }
    .subsubmenuBar{
     background-color: #dddddd;
            height: calc(100% - 20px);
    }



    @media only screen and (max-width: 992px) {
    #subsubMenu{
          height: 70px;
        background-color: white;
        margin-top: 40px;
        margin-bottom: 20px;
        border-radius: 8px;  
    }

    .subsubmenuBox{
     background-color: rgba(0,0,0,0);
     height: 100%;
     padding: 10px 20px 0px 20px;
     font-size:18px;
     text-align:center;
     color:#6c6c6c;
     float: left;
         cursor: pointer;
    }
    }
    @media only screen and (min-width: 992px) {
    #subsubMenu{
          height: 90px;
        background-color: white;
        margin-top: 40px;
        margin-bottom: 20px;
        border-radius: 8px;  
    }

    .subsubmenuBox{
     background-color: rgba(0,0,0,0);
     height: 100%;
     padding: 20px 30px 0px 30px;
     font-size:24px;
     text-align:center;
     color:#6c6c6c;
     float: left;
         cursor: pointer;
    }
    }


    .subsubmenuBox-Active{
     color:#bc0000;
     background-color: #ffffff;
    }
    .subsubmenuBox-Active p{
     color:#bc0000;
        border-bottom: 4px solid #bc0000 !important;
    }
    .subsubmenuBox p{
     color:#6c6c6c;
        margin: 0px;
        border-bottom: 0px solid #bc0000;
    }
    .subsubmenuBox-Active a{
     color:#bc0000;
        
    }
    .subsubmenuBox a{
     color:#6c6c6c;

    }
    .stepbar{
        height:377px;border-radius: 8px;background-color: #fff; padding-top: 55px;padding-left:72px;
    }
    .inst{
    display: block;
        padding: 0px !important;
    }
    .inst-form{
 max-width:none;
    }
    .enqu{
    display: none;

    }

    .stepBottomBar{
        width:100%; 
    }
    #stepback{
      height:87px; background-color: #9b9b9b;text-align: center;font-size: 20px;vertical-align: middle;line-height: 87px;color:#fff;cursor: pointer;  
    }
    #stepgo{
        height:87px; background-color: #4a4a4a;text-align: center;font-size: 20px;vertical-align: middle;line-height: 87px;color:#fff;cursor: pointer;
    }

    .menustepArea{
        padding:0;margin:0;
    }
    .menustepIcon{
    display:none;width:16px;height:16px;
    }
    .menustepText{
    text-align:left;color:#666;font-size: 16px;line-height: 24px;
    }
    .menustepText-Active{
    text-align:left;color:#d94634;font-size: 16px;line-height: 24px;
    }
    .radionewlabel{
        color: #333;
    }
    .newinstselect{
        height: 78px;
        display: table;
    }
    .newinstselectitem{
    }
    .custselectitem select {
      padding:5px 5px 5px 10px;
      background: transparent;
      border: none;
      font-size: 0.8em; 
      padding: 5px;
      width: 100%;
      color: black;
    }
    .custselectitem{ 
      padding:5px 5px 5px 10px;
      overflow: hidden;
      width: 100%;
      background-color:white;
      -webkit-border-radius: 20px;
      -moz-border-radius: 20px;
      border-radius: 20px;  
      border:1px solid #999;
    }
</style>
<section>
<div class="row" style="max-width: 1300px;">
<div class="col s12 m12 l12" style="padding:0">
<div id="subsubMenu">
<div class="redbartop">&nbsp;</div>

<div class="subsubmenuBar">
<div class="subsubmenuBox subsubmenuBox-Active" data-gmnsubsubmenu="inst">
<p>Cash Deposit Instruction</p>
</div>

<div class="subsubmenuBox" data-gmnsubsubmenu="enqu">
<p><a href="../deposit-Instruction-enquiry/">Cash Deposit Instruction Enquiry</a></p>
</div>
</div>
</div>
</div>

<div class="col s12 m12 l12 inst"><!-- right menu -->
<div class="col s12 m12 l3 hidewhenmobile" style="padding:0 0.75rem 0 0">
<div class="stepbar">
<table>
  <tbody>
    <tr>
      <td class="menustepArea"><img class="menustepIcon" id="stepbarstepicon1" src="../../../images/status_icon.png" /></td>
      <td class="menustepArea">
      <p class="menustepText" id="stepbarstep1">Instruction</p>
      </td>
    </tr>
    <tr>
      <td class="menustepArea"><img class="menustepIcon" id="stepbarstepicon2" src="../../../images/status_icon.png" /></td>
      <td class="menustepArea">
      <p class="menustepText" id="stepbarstep2">Confirmation</p>
      </td>
    </tr>
    <tr>
      <td class="menustepArea"><img class="menustepIcon" id="stepbarstepicon3" src="../../../images/status_icon.png" /></td>
      <td class="menustepArea">
      <p class="menustepText" id="stepbarstep3">Completion</p>
      </td>
    </tr>
  </tbody>
</table>
</div>
</div>
<!-- right menu -->

<div class="col s12 m12 l9" style="padding:0">
<div class="row inst-form gem_form " style="margin-left: 0px;min-height:515px"><!-- <form> -->
<div class="overviewpage">
<form>
<div class="col s12">
<h5 class="inst-form-1sttitle">Cash Deposit Instruction</h5>
</div>

<div class="inst-area-one row">
<div class="col s12 m12 l12 inst-grid-t inst-grid-b">
<div>
<div class="cashTradingBtn cashTradingActive" data-tradtype="depositItem">Deposit</div>

<div class="cashTradingBtn" data-tradtype="withdrawItem">Withdrawal</div>
</div>
</div>

<div class="col s12 m12 l12 inst-grid-t inst-grid-b">
<div class="row">
<div class="col s4 m4 l4">
<p class="inst-form-label label-left">Account Type</p>
</div>

<div class="col s8 m8 l8 row">
<div class="col s12 m12 l6 cbcitem">
<div class="inst-form-comboboxItem"><input checked="checked" class="with-gap" id="choice_custodian" name="AccountType" type="radio" value="1" /> <label class="radionewlabel" for="choice_custodian"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> Cash Account</label></div>
</div>

<div class="col s12 m12 l6 marginchoice cbcitem">
<div class="inst-form-comboboxItem"><input class="with-gap" id="choice_margin" name="AccountType" type="radio" value="2" /> <label class="radionewlabel" for="choice_margin"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> Margin </label></div>
</div>
</div>
</div>
</div>
</div>

<div class="inst-area-two row">
<div class="col s12 m12 l12 inst-grid-b">
<div class="row">
<div class="col s4 m4 l4">
<p class="inst-form-label label-left mobile-label">Settle Method</p>
</div>

<div class="col s8 m8 l8 row">
<div class="col s12 m12 l4 cbcitem">
<div class="inst-form-comboboxItem"><input checked="checked" class="with-gap" id="choice_transfer" name="transferMethod" type="radio" value="F" /> <label class="radionewlabel" for="choice_transfer"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> By Transfer </label></div>
</div>

<div class="col s12 m12 l4 cbcitem">
<div class="inst-form-comboboxItem"><input class="with-gap" id="choice_cheque" name="transferMethod" type="radio" value="R" /> <label class="radionewlabel" for="choice_cheque"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> By Cheque </label></div>
</div>

<div class="col s12 m12 l4 cbcitem">
<div class="inst-form-comboboxItem"><input class="with-gap" id="choice_telex" name="transferMethod" type="radio" value="T" /> <label class="radionewlabel" for="choice_telex"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> By T/T </label></div>
</div>
</div>
</div>
</div>

<div class="col s12 m12 l12 inst-grid-b">
<div class="row">
<div class="col s4 m4 l4">
<p class="inst-form-label label-left">Withdaw to</p>
</div>

<div class="col s8 m8 l8 row">
<div class="col s12 m12 l6 cbcitem">
<div class="inst-form-comboboxItem"><input checked="checked" class="with-gap" id="choice_local" name="transferacctType" type="radio" value="1" /> <label class="radionewlabel" for="choice_local"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> Local Bank </label></div>
</div>

<div class="col s12 m12 l6 cbcitem">
<div class="inst-form-comboboxItem"><input class="with-gap" id="choice_overseas" name="transferacctType" type="radio" value="2" /> <label class="radionewlabel" for="choice_overseas"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> Oversea Bank </label></div>
</div>
</div>
</div>
</div>
</div>
<!-- miss                     -->

<div class="inst-area-seven row">
<div class="col s12 m12 l12 inst-grid-b">
<div class="row">
<div class="col  s4 m4 l4">
<p class="inst-form-label  label-left mobile-label">Settle Method</p>
</div>

<div class="col s8 m8 l8 row">
<div class="col s12 m12 l4 cbcitem">
<div class="inst-form-comboboxItem"><input checked="checked" class="with-gap" id="choice_transfer2" name="transferMethod2" type="radio" value="F" /> <label class="radionewlabel" for="choice_transfer2"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> By Transfer </label></div>
</div>

<div class="col s12 m12 l4 cbcitem">
<div class="inst-form-comboboxItem"><input class="with-gap" id="choice_cheque2" name="transferMethod2" type="radio" value="R" /> <label class="radionewlabel" for="choice_cheque2"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> By Cheque </label></div>
</div>

<div class="col s12 m12 l4 cbcitem">
<div class="inst-form-comboboxItem"><input class="with-gap" id="choice_telex2" name="transferMethod2" type="radio" value="T" /> <label class="radionewlabel" for="choice_telex2"> <span class="inst-form-greenbox-base"> <span class="inst-form-greenbox">&nbsp;</span></span> By T/T </label></div>
</div>
</div>
</div>
</div>
</div>
<!-- miss -->

<div class="inst-area-three row"><!-- <div class="col s4 m4 l4 inst-form-select includecurrency inst-grid-b"> -->
<div class="col s12 m12 l12 inst-grid-b newinstselect">
<div style="width:34%;display: inline-block;    vertical-align: top;padding-top: 26px;">
<div class="newinstselectitem">
<div class="custselectitem"><select id="field_currency"><option disabled="disabled" selected="selected" value="">Currency</option><option value="HKD">HKD</option><option value="USD">USD</option><option value="EUR">EUR</option><option value="AUD">AUD</option><option value="CNY">CNY</option><option value="JPY">JPY</option><option value="GBP">GBP</option><option value="SGD">SGD</option><option value="CHF">CHF</option><option value="MYR">MYR</option> </select></div>
</div>

<p id="field_currency_vaillab" style="font-size: 0.7em;margin:5px;line-height: 0.9em;color:#e74c3c;">&nbsp;</p>
</div>

<div style="width:66%;display: inline-block;  vertical-align: top;">
<div class="gem_form materialize remove-gemform-s">
<div class="row">
<div class="input-field col s12"><input class="validate labelfield" id="field_amount" type="number" /> <label class="labelfield-text" for="field_amount">Amount</label>

<p id="field_amount_vaillab" style="font-size: 0.7em;margin:5px;line-height: 0.9em;color:#e74c3c;">&nbsp;</p>
</div>
</div>
</div>
</div>
</div>

<div class="col s12 m12 l12">
<div class="gem_form materialize remove-gemform-s">
<div class="row">
<div class="input-field col s12"><!-- <input class="validate labelfield" maxlength="100" id="field_remarks" type="text" /> <label class="labelfield-text labelfield-left" for="field_remarks">備註</label> --><textarea class="materialize-textarea" id="remarkarea" maxlength="100"></textarea><label for="remarkarea">Remark</label></div>
</div>
</div>
</div>
</div>

<h6 class="inst-tips">* Do not accept third party transfer</h6>

<div class="col s12">
<h5 class="inst-form-2ndtitle withdrawTitle">Cash Withdraw to</h5>
</div>

<div class="inst-area-four row">
<div class="col s12 m12 l6 inst-grid-t inst-grid-b editable">
<div class="gem_form materialize remove-gemform-s">
<div class="row">
<div class="input-field col s12 "><input class="validate labelfield" id="field_bankname" type="text" /> <label class="labelfield-text labelfield-left" for="field_bankname">Bank Name</label>

<p id="field_bankname_vaillab" style="font-size: 0.7em;margin:5px;line-height: 0.9em;color:#e74c3c;">&nbsp;</p>
</div>
</div>
</div>
</div>

<div class="col s12 m12 l6 inst-grid-t inst-grid-r inst-grid-b">
<div class="gem_form materialize remove-gemform-s">
<div class="row">
<div class="input-field col s12"><input class="validate labelfield" id="field_bankaccountname" type="text" /> <label class="labelfield-text labelfield-left" for="field_bankaccountname">Customer Name</label>

<p id="field_bankaccountname_vaillab" style="font-size: 0.7em;margin:5px;line-height: 0.9em;color:#e74c3c;">&nbsp;</p>
</div>
</div>
</div>
</div>
</div>

<div class="inst-area-five row">
<div class="col s12 m12 l6 inst-grid-b">
<div class="gem_form materialize remove-gemform-s">
<div class="row">
<div class="input-field col s12"><input class="validate labelfield" id="field_bankaccountnum" type="text" /> <label class="labelfield-text labelfield-left" for="field_bankaccountnum">Bank Account No</label>

<p id="field_bankaccountnum_vaillab" style="font-size: 0.7em;margin:5px;line-height: 0.9em;color:#e74c3c;">&nbsp;</p>
</div>
</div>
</div>
</div>

<div class="col s12 m12 l6 inst-grid-r inst-grid-b">
<div class="gem_form materialize remove-gemform-s">
<div class="row">
<div class="input-field col s12"><input class="validate labelfield" id="field_bankswiftcode" type="text" /> <label class="labelfield-text labelfield-left" for="field_bankswiftcode">Bank / Swift Code</label>

<p id="field_bankswiftcode_vaillab" style="font-size: 0.7em;margin:5px;line-height: 0.9em;color:#e74c3c;">&nbsp;</p>
</div>
</div>
</div>
</div>
</div>
<!-- new requirement -->

<div class="col s12">
<h5 class="inst-form-2ndtitle clientdataTitle" style="margin: 56px 0px 0px 0px !important;">Cash Deposit From</h5>
</div>

<div class="inst-area-clientarea row">
<div class="col s12 m12 l6 inst-grid-t inst-grid-b">
<div class="gem_form materialize remove-gemform-s">
<div class="row">
<div class="input-field col s12"><input class="validate labelfield" id="field_cashd_bankacctno" type="text" /> <label class="labelfield-text labelfield-left" for="field_cashd_bankacctno">Account No</label></div>
</div>
</div>
</div>

<div class="col s12 m12 l6 inst-grid-t inst-grid-r inst-grid-b">
<div class="gem_form materialize remove-gemform-s">
<div class="row">
<div class="input-field col s12"><input class="validate labelfield" id="field_cashd_bankid" type="text" /> <label class="labelfield-text labelfield-left" for="field_cashd_bankid">Bank Code</label></div>
</div>
</div>
</div>
</div>
<!-- new requirement -->

<div class="col s12 instdetailsinfo">
<h5 class="inst-form-2ndtitle depositTitle">Instruction Details</h5>
</div>

<div class="inst-area-six row">
<div class="col s12 companyAcctArea">
<ul class="col s12 m12 l12 companyAcctArea-info normaCurArea">
  <li>Please deposit into the following bank account</li>
  <li>Bank Name: The Hongkong and Shanghai Banking Corporation Limited</li>
  <li>SWIFT Code: HSBCHKHH</li>
  <li>Bank Address: No 1 Queen&#39;s Road Central, Hong Kong</li>
  <li>Account Name: Geminis Securities Limited &ndash; Client Trust A/C</li>
  <li>Account No: <span class="dynamicAcctNo">500-357561-292 (HKD)</span></li>
  <li>&nbsp;</li>
  <li>*Please write down the account no and your name on the bank slip or T/T receipt, and email it to xxxxx@geminisgroup.com or fax it to us at xxxxxx</li>
</ul>

<ul class="col s12 m12 l12 companyAcctArea-info usdCurArea">
  <li>Please deposit into the following bank account</li>
  <li>Bank Name: The Hongkong and Shanghai Banking Corporation Limited</li>
  <li>SWIFT Code: HSBCHKHH</li>
  <li>Bank Address: No 1 Queen&#39;s Road Central, Hong Kong</li>
  <li>Account Name: Geminis Securities Limited &ndash; Client Trust A/C</li>
  <li>Account No: <span class="dynamicAcctNo">500-357561-274 (USD)</span></li>
  <li>&nbsp;</li>
  <li>Intermediary Bank</li>
  <li>Bank Name: HSBC Bank, USA, New York</li>
  <li>Account No: 000-04441-5</li>
  <li>Chips Code: UID#075995</li>
  <li>SWIFT Code: MRMDUS33</li>
  <li>&nbsp;</li>
  <li>*Please write down the account no and your name on the bank slip or T/T receipt, and email it to xxxxx@geminisgroup.com or fax it to us at xxxxxx</li>
</ul>
</div>
</div>
</form>
</div>
<!-- </form> --><!-- <form> -->

<div class="confirmpage">
<div class="area-top">
<div class="col s12 inst-grid-b">
<h5 class="inst-form-1sttitle">Cash Deposit Instruction</h5>
</div>

<div class="inst-area-one row inst-grid-b " id="cfmArea">&nbsp;</div>

<div class="inst-area-three row inst-grid-b">
<div class="col s12">
<div class="col s12 m6 l2">
<h5 style="line-height: 60px">OTP</h5>
</div>

<div class="col s12 m6 l10">
<div class="gem_form materialize remove-gemform-s">
<div class="row">
<div class="input-field col s12 m6 l6"><input autocomplete="false" class="validate labelfield" id="field_passwords" type="text" /> <label class="labelfield-text labelfield-left" for="field_passwords">Please enter OTP</label>

<p id="otplabel" style="font-size: 0.7em;margin:5px;line-height: 0.9em;color:#e74c3c;">&nbsp;</p>
</div>

<div class="col s12 m6 l6" style="text-align: center;"><input class="generic-button-standalone gb-primary font_lg" id="acc_btn_otp" type="button" value="Get OTP" /></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- </form> --><!-- <form> -->

<div class="completepage">
<div class="area-top">
<div class="col s12" style="min-height: 400px; padding-top: 66px !important;">
<p class="finishmsg" style="text-align: center;"><img class="msgiconfinish" src="../../../images/complete icon.png" /></p>

<p class="finishmsg" id="callstate" style="text-align: center;">Completion</p>

<p class="refnumlabel" id="calldesc" style="text-align: center;">Ref. No: 000000</p>
</div>
</div>
</div>
<!-- </form> --></div>
</div>
</div>
</div>

<div class="row inst stepBottomBar">
<div class="col s12 m12 l3 " id="stepback">Back</div>

<div class="col s12 m12 l9" id="stepgo">Next</div>
</div>
</section>
<script>



$(function(e) {
$(".editable").on("click", function() {
  // $(this).find('input[type=text]').trigger('focus');
  $('#field_bankname').trigger('focus');
});
$('.subsubmenuBox').on('click',function(e){
    var subsubItem = $(this).data().gmnsubsubmenu;
    if(subsubItem == 'inst'){
    }
    if(subsubItem == 'enqu'){
        turnLoader('c');
window.location.href="../deposit-Instruction-enquiry/";

    }
});

$('#acc_btn_otp').click(function(e){

    callOTP(function(e){

    });

});


    window.callOTP = function callOTP(callback){
        turnLoader('c');

        $.post('/api/usercode/registerfromsession',
              {
                  email:'kaycheung@cherrypicks.com',
              })
              .done( function(msg) {
                  if (msg.success)
                  {
                turnLoader();
                      alert('Success, please check your email.');
                (callback && typeof(callback) === "function") && callback();
                  }
                  else
                  {
                turnLoader();
                      alert(msg.message);
                (callback && typeof(callback) === "function") && callback();
                  }
              })
              .fail( function(xhr, textStatus, errorThrown) {
                turnLoader();
                  alert("Network Error");
                (callback && typeof(callback) === "function") && callback();
              });      

    }


    window.loadUIDataSet = function loadUIDataSet() {

        var dataSet = {}
        dataSet.acct = "9910-268";
        dataSet.pwd = "12345678";
        dataSet.loginid = "@{S:CLIENTID}";
        // dataSet.loginid = "9910-268";
        dataSet.loginpw = "12345678";
        return dataSet;
    }

    window.serCallHandle = function serCallHandle(res,trueFlag){
        console.log("Res - Data ", res.data);
        if(!trueFlag){
                    $(".msgiconfinish").attr('src','../../../images/notcomplete-icon.png');
                    $("#callstate").text(nls.fail);
                    $("#calldesc").text(nls.failmsg);
        }else{
            if (res.data) {
                if(res.data.isSuccess && res.data.isSuccess == 'Y'){
                    $(".msgiconfinish").attr('src','../../../images/complete icon.png');
                    $("#callstate").text(nls.success);
                    if(res.data.transactionID && res.data.transactionID !=''){
                        $("#calldesc").text(nls.desc + res.data.transactionID);
                    }else{
                        $("#calldesc").text('');
                    }
                }else{
                    $(".msgiconfinish").attr('src','../../../images/notcomplete-icon.png');
                    $("#callstate").text(nls.fail);
                    $("#calldesc").text(nls.failmsg);
                }
            }else{
                // otp error
                if(res.message == 'OTP Incorrect' && res.responseCode == 'F002' && res.success == false){
                    glootperror = true;
                }
              
              $(".msgiconfinish").attr('src','../../../images/notcomplete-icon.png');
                    $("#callstate").text(nls.fail);
                    $("#calldesc").text(nls.failmsg);
            }
        }       
    }
    window.callSOAPapi = function callSOAPapi(loaddata, callback) {
        turnLoader('c');
        $.ajax({
            type: 'POST',
            url: '/api/session/submitSoapQuery',
            contentType: 'application/json',
            data: JSON.stringify(loaddata),
            dataType: 'json',
            success: function(responseData, textStatus, jqXHR) {
                serCallHandle(responseData,true);
                // console.log("SerCall - " + loaddata.form.name, responseData);
                // if (responseData.data) {
                    // console.log("Res - Data ", responseData.data);
                // }
        turnLoader();
                (callback && typeof(callback) === "function") && callback();
            },
            error: function(responseData, textStatus, errorThrown) {
                serCallHandle(responseData,false);
                // console.log("SerCall - " + loaddata.form.name, responseData);
        turnLoader();
                (callback && typeof(callback) === "function") && callback();
            }
        });
    }

    window.convtoi18n = function convtoi18n(lang,culture){
        var langculture = [];
        var sellang = lang+'_'+culture;
        langculture['zh_HK'] = "zh_TW";
        langculture['zh_TW'] = "zh_TW";
        langculture['zh_CN'] = "zh_CN";
        langculture['en_US'] = "en_US";
        if(langculture[sellang] == undefined){
            return 'en_US';
        }else{
            return langculture[sellang];
        }
    }
    window.formatAmount = function formatAmount(n, currency) {
        if(isNaN(n)){
            return '';
        }else{
            return currency + " " + n.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,");
        }
    }

    window.loadstep = function loadstep(step) {
        switch (step) {
            case 1:
                loadoverview();
                break;
            case 2:
                loadconfirm();
                break;
            case 3:
                loadcomplete();
                break;
            case 4:
                reloadPage();
                break;
            default:
                ;
        }
    }

    window.handlestepcolor = function handlestepcolor(step) {
        switch (step) {
            case 1:
                $('#stepbarstepicon1').show();
                $('#stepbarstepicon2').hide();
                $('#stepbarstepicon3').hide();
                
                $('#stepbarstep1').addClass('menustepText-Active');
                $('#stepbarstep2').removeClass('menustepText-Active');
                $('#stepbarstep3').removeClass('menustepText-Active');
                // $('#stepbarstep1').attr('style', 'text-align:left;color:#d94634;font-size: 16px;line-height: 24px;');
                // $('#stepbarstep2').attr('style', 'text-align:left;color:#666;font-size: 16px;line-height: 24px;');
                // $('#stepbarstep3').attr('style', 'text-align:left;color:#666;font-size: 16px;line-height: 24px;');;
                break;
            case 2:
                $('#stepbarstepicon1').hide();
                $('#stepbarstepicon2').show();
                $('#stepbarstepicon3').hide();
                $('#stepbarstep1').removeClass('menustepText-Active');
                $('#stepbarstep2').addClass('menustepText-Active');
                $('#stepbarstep3').removeClass('menustepText-Active');                
                // $('#stepbarstep1').attr('style', 'text-align:left;color:#666;font-size: 16px;line-height: 24px;');
                // $('#stepbarstep2').attr('style', 'text-align:left;color:#d94634;font-size: 16px;line-height: 24px;');
                // $('#stepbarstep3').attr('style', 'text-align:left;color:#666;font-size: 16px;line-height: 24px;');;
                break;
            case 3:
                $('#stepbarstepicon1').hide();
                $('#stepbarstepicon2').hide();
                $('#stepbarstepicon3').show();
                $('#stepbarstep1').removeClass('menustepText-Active');
                $('#stepbarstep2').removeClass('menustepText-Active');
                $('#stepbarstep3').addClass('menustepText-Active');                
                // $('#stepbarstep1').attr('style', 'text-align:left;color:#666;font-size: 16px;line-height: 24px;');
                // $('#stepbarstep2').attr('style', 'text-align:left;color:#666;font-size: 16px;line-height: 24px;');
                // $('#stepbarstep3').attr('style', 'text-align:left;color:#d94634;font-size: 16px;line-height: 24px;');;
                break;
            default:
                ;
        }
    }

    window.reloadPage = function reloadPage() {

        window.location.reload();

    }

    window.loadpage = function loadpage(page) {
        $('.overviewpage').hide();
        $('.confirmpage').hide();
        $('.completepage').hide();
        $('.' + page).show();
    }

    window.loadoverview = function loadoverview() {
        loadpage('overviewpage');
        $('#field_passwords').val('');
        $('#stepgo').text(nls.nextstep);
        handlestepcolor(1);
        glostepback = 1;
        glostepgo = 2;
    }

    window.loadcomplete = function loadcomplete() {
        var field_passwords = $('#field_passwords').val();
        var localInfo = loadUIDataSet();
        // if(field_passwords =='' || field_passwords != localInfo.loginpw){
        if (field_passwords == '') {
            $('#otplabel').text(nls.plsfillpwd);
            // alert(nls.plsfillpwd);
        } else {
            var d = instFormData;
            if (d.Instruction == 'D') {
                instSettlementForm = {
                    channelID: 'INT',
                    clientID: glo.clientid,
                    tradingAccSeq: d.TradingAccSeq,
                    amount: d.Amount,
                    currencyID: d.CurrencyID,
                    settleMethod: d.SettleMethod,
                    remark: d.StatementRemark,
                    bankAccount: d.BankAccount,
                    bankID: d.BankID,
                    language: glo.locallang,
                    sessionID: glo.sessionid
                }
                window.getinstSessionExpireMsg = function getinstSessionExpireMsg(lang){
                    var msgData = {};
                    switch(lang){
                        case 'zh-HK': 
                            msgData.title = '登入超時' ;
                            msgData.text = '登入超時，請重新登入。' ;
                            break;
                        case 'zh-CN': 
                            msgData.title = '登入超时' ;
                            msgData.text = '登入超时，请重新登入。' ;
                            break;
                        case 'en-US': 
                        default:
                            msgData.title = 'Session Timeout' ;
                            msgData.text = 'Session Timeout, Please login again.' ;
                    }
                    return msgData;
                }

                var msglang = "@{S:LANG}"+"-"+"@{S:CULTURE}";
                var msg = getinstSessionExpireMsg(msglang);

                $.ajax({
                    type: 'POST',
                    url: '/api/session/isLogin',
                    success: function(responseData, textStatus, jqXHR) {
                       if(responseData == "True"){
                                depositCash(field_passwords,function() {
                                    if(glootperror){
                                        $('#otplabel').text(nls.otperror);
                                        glootperror = false;     
                                        return;
                                    }
                                    loadpage('completepage');
                                    $('#stepgo').text(nls.done);
                                    handlestepcolor(3);
                                    glostepback = 0;
                                    glostepgo = 4;
                                });

                       }else{
                       swal({
                          title: msg.title,
                          text: msg.text,
                          timer: 2000,
                          showConfirmButton: false
                        });
                       setTimeout(function(){ location.reload(); }, 3000);
                       }
                    },
                    error: function(responseData, textStatus, errorThrown) {
                       swal({
                          title: msg.title,
                          text: msg.text,
                          timer: 2000,
                          showConfirmButton: false
                        });
                       setTimeout(function(){ location.reload(); }, 3000);
                    }
                });
            } else {
                instSettlementForm = {
                    channelID: 'INT',
                    clientID: glo.clientid,
                    tradingAccSeq: d.TradingAccSeq,
                    amount: d.Amount,
                    currencyID: d.CurrencyID,
                    settleMethod: d.SettleMethod,
                    remark: d.StatementRemark,
                    bankAccount: d.BankAccount,
                    bankID: d.BankID,
                    bankName: d.BankName,
                    bankAccountName: d.BankAccountName,
                    bankSwiftCode: d.BankSwiftCode,
                    language: glo.locallang,
                    sessionID: glo.sessionid
                }
                window.getinstSessionExpireMsg = function getinstSessionExpireMsg(lang){
                    var msgData = {};
                    switch(lang){
                        case 'zh-HK': 
                            msgData.title = '登入超時' ;
                            msgData.text = '登入超時，請重新登入。' ;
                            break;
                        case 'zh-CN': 
                            msgData.title = '登入超时' ;
                            msgData.text = '登入超时，请重新登入。' ;
                            break;
                        case 'en-US': 
                        default:
                            msgData.title = 'Session Timeout' ;
                            msgData.text = 'Session Timeout, Please login again.' ;
                    }
                    return msgData;
                }

                var msglang = "@{S:LANG}"+"-"+"@{S:CULTURE}";
                var msg = getinstSessionExpireMsg(msglang);

                $.ajax({
                    type: 'POST',
                    url: '/api/session/isLogin',
                    success: function(responseData, textStatus, jqXHR) {
                       if(responseData == "True"){
                                withdrawCash(field_passwords,function() {
                                    if(glootperror){
                                        $('#otplabel').text(nls.otperror);
                                        glootperror = false;     
                                        return;
                                    }
                                    loadpage('completepage');
                                    $('#stepgo').text(nls.done);
                                    handlestepcolor(3);
                                    glostepback = 0;
                                    glostepgo = 4;
                                });

                       }else{
                       swal({
                          title: msg.title,
                          text: msg.text,
                          timer: 2000,
                          showConfirmButton: false
                        });
                       setTimeout(function(){ location.reload(); }, 3000);
                       }
                    },
                    error: function(responseData, textStatus, errorThrown) {
                       swal({
                          title: msg.title,
                          text: msg.text,
                          timer: 2000,
                          showConfirmButton: false
                        });
                       setTimeout(function(){ location.reload(); }, 3000);
                    }
                });                
            }
        }
    }

    window.vaildationEmpty = function vaildationEmpty(item,dom,label,t){
        var state = false;
        var msgstart = '';
        t == 's'? msgstart = nls.choosedata: msgstart = nls.fillindata;
        if(item == "" || item == null){
          state = true;
        }
        if(state == true){
          alert(msgstart+label);
          $( dom).trigger('focus');
        }
        return state; 
    }

    window.loadconfirm = function loadconfirm() {
        var field_bankname = $('#field_bankname').val();
        var field_bankaccountname = $('#field_bankaccountname').val();
        var field_bankaccountnum = $('#field_bankaccountnum').val();
        var field_bankswiftcode = $('#field_bankswiftcode').val();
        var field_amount = $('#field_amount').val();
        var field_currency = $('#field_currency').val();
        var vailstate = true;

        function popwarning(field){
          var msg = '';
          if(field == 'a'){
            msg = nls.fillindata+nls.amount;
          }
          if(field == 'c'){
            msg = nls.choosedata+nls.currency;
          }
          if(field == '0'){
            msg = nls.amounterror;
          }
          if(field == 'bn'){
            msg = nls.fillindata+nls.bankname;
          }
          if(field == 'ban'){
            msg = nls.fillindata+nls.bankaccountname;
          }
          if(field == 'bno'){
            msg = nls.fillindata+nls.bankaccountnum;
          }
          if(field == 'bsc'){
            msg = nls.fillindata+nls.bankcode;
          }
          return msg;
        }
        function resetamtcur(){
            $('#field_currency_vaillab').html('&nbsp');
            $('#field_amount_vaillab').html('&nbsp');
        }
        function resetWbankinfo(){
            $('#field_bankname_vaillab').html('&nbsp');
            $('#field_bankaccountname_vaillab').html('&nbsp');
            $('#field_bankaccountnum_vaillab').html('&nbsp');
            $('#field_bankswiftcode_vaillab').html('&nbsp');
                $('#otplabel').html('&nbsp');
        }

        if(!debuggermode){
            if (glo.sessionid == '' || glo.clientid == '') {
                alert(nls.loginacctfirst);
                return;
            }
        }

        if(instFormData.Instruction == 'W'){
           resetWbankinfo();
                var pre_field_bankname = field_bankname.replace(/ /g,'');

                if(pre_field_bankname == ''){
                    $('#field_bankname_vaillab').text(popwarning('bn'));
                    vailstate = false;

                }
                var pre_field_bankaccountname = field_bankaccountname.replace(/ /g,'');
                if(pre_field_bankaccountname == ''){
                    $('#field_bankaccountname_vaillab').text(popwarning('ban'));
                    vailstate = false;

                }
                var pre_field_bankaccountnum = field_bankaccountnum.replace(/ /g,'');
                if(pre_field_bankaccountnum == ''){
                    $('#field_bankaccountnum_vaillab').text(popwarning('bno'));
                    vailstate = false;

                }
                var pre_field_bankswiftcode = field_bankswiftcode.replace(/ /g,'');
                if(pre_field_bankswiftcode == ''){
                    $('#field_bankswiftcode_vaillab').text(popwarning('bsc'));
                    vailstate = false;

                }
 
        }
           resetamtcur();

            if(field_currency == '' || field_currency == null) {
                $('#field_currency_vaillab').text( popwarning('c'));
                vailstate = false;
            }

            if(field_amount == ''){
                $('#field_amount_vaillab').text( popwarning('a'));
                vailstate = false;
            }

            //check zero amount
            if(parseFloat(field_amount) == 0){
                $('#field_amount_vaillab').text(popwarning('0'));
                vailstate = false;
            }

            if(vailstate == false){
                vailstate = true;
                return;
            }

            loadDesktopUItoData(function() {
                loadDatatoConfirmUI(instFormData);
                loadpage('confirmpage');
                handlestepcolor(2);
                glostepback = 1;
                glostepgo = 3;
            });
        
    }
    window.loadDatatoConfirmUI = function loadDatatoConfirmUI(data) {
        var d = data;
        var temp = '\
            <table class="confirmbox">\
                 <tr><td colspan="2">' + d.InstructionName + '</td></tr>\
                 <tr><td width="25%">' + nls.transacct + '：</td><td>' + d.TradingAccSeqName + '</td></tr>\
                 <tr><td>' + nls.transmethod + '：</td><td>' + d.SettleMethodName + '</td></tr>\
                 <tr><td>' + nls.currency + '：</td><td>' + d.CurrencyID + ' ' + formatAmount(parseFloat(d.Amount),'') + '<td></tr>\
                 <tr><td>' + nls.remark + '：</td><td>' + d.StatementRemark + '</td></tr>';
        if (d.transferacctTypeName) {
            temp += '<tr><td>' + nls.cashfrom + '：</td><td>' + d.transferacctTypeName + '</td></tr>';
        }
        if (d.BankName) {
            temp += '<tr><td>' + nls.bankname + '：</td><td>' + d.BankName + '</td></tr>';
            temp += '<tr><td>' + nls.bankaccountname + '：</td><td>' + d.BankAccountName + '</td></tr>';
            temp += '<tr><td>' + nls.bankaccountnum + '：</td><td>' + d.BankAccount + '</td></tr>';
            temp += '<tr><td>' + nls.bankcode + '：</td><td>' + d.BankSwiftCode + '</td></tr>';
        }
        temp += '</table>'; 

        $('#cfmArea').empty().append(temp);
    }

    window.loadDesktopUItoData = function loadDesktopUItoData(callback) {

        if (instFormData.Instruction == 'W') {
            instFormData = {};
            instFormData.Instruction = 'W';

            instFormData.BankID = '';
            instFormData.BankName = $('#field_bankname').val();
            instFormData.BankAccountName = $('#field_bankaccountname').val();
            instFormData.BankAccount = $('#field_bankaccountnum').val();
            instFormData.BankSwiftCode = $('#field_bankswiftcode').val();
            instFormData.transferacctType = $('input[name="transferacctType"]:checked').val();
            instFormData.transferacctType == 1 && (instFormData.transferacctTypeName = nls.localbank);
            instFormData.transferacctType == 2 && (instFormData.transferacctTypeName = nls.overseabank);

            instFormData.SettleMethod = $('input[name="transferMethod"]:checked').val();

        } else {
            instFormData = {};
            instFormData.Instruction = 'D';

            instFormData.BankID = $('#field_cashd_bankid').val();
            instFormData.BankAccount = $('#field_cashd_bankacctno').val();


            instFormData.SettleMethod = $('input[name="transferMethod2"]:checked').val();

        }
        instFormData.Amount = $('#field_amount').val();
        instFormData.CurrencyID = $('#field_currency').val();
        // instFormData.StatementRemark = $('#field_remarks').val();
        instFormData.StatementRemark = $('#remarkarea').val();
        instFormData.SettleMethod == 'F' && (instFormData.SettleMethodName = nls.transfer);
        instFormData.SettleMethod == 'R' && (instFormData.SettleMethodName = nls.cheuqe);
        instFormData.SettleMethod == 'T' && (instFormData.SettleMethodName = nls.telex);
        instFormData.TradingAccSeq = $('input[name="AccountType"]:checked').val();
        instFormData.TradingAccSeq == 1 && (instFormData.TradingAccSeqName = nls.Custodian);
        instFormData.TradingAccSeq == 2 && (instFormData.TradingAccSeqName = nls.Margin);
        instFormData.Instruction == 'D' && (instFormData.InstructionName = nls.deposit);
        instFormData.Instruction == 'W' && (instFormData.InstructionName = nls.withdraw);

        console.log("From Data: - ", instFormData);
        (callback && typeof(callback) === "function") && callback();
    }


    window.depositCash = function depositCash(otpVal,callback) {

        var loadDS = loadUIDataSet();
        var dataSet = {
            "form": {
                "name": "cashDepositInstruction",
                "credentials": {
                    "username": loadDS.acct,
                    "password": loadDS.pwd
                },
                "header": {
                    "version": "1",
                    "traceNo": "1"
                },
              "otp": otpVal,
                "body": instSettlementForm
            }
        }
        callSOAPapi(dataSet, function() {
            (callback && typeof(callback) === "function") && callback();
        });
    }
    window.withdrawCash = function withdrawCash(otpVal,callback) {

        var loadDS = loadUIDataSet();
        var dataSet = {
            "form": {
                "name": "cashWithdrawalInstruction",
                "credentials": {
                    "username": loadDS.acct,
                    "password": loadDS.pwd
                },
                "header": {
                    "version": "1",
                    "traceNo": "1"
                },
              "otp": otpVal,
                "body": instSettlementForm
            }
        }
        callSOAPapi(dataSet, function() {
            (callback && typeof(callback) === "function") && callback();
        });
    }

    window.loadtipsforCur = function loadtipsforCur(cur){
        var currencyLabel = [];
        currencyLabel['HKD'] = '500-357561-292 (HKD)';
        currencyLabel['USD'] = '500-357561-274 (USD)';
        currencyLabel['EUR'] = '500-357561-275 (EUR)';
        currencyLabel['AUD'] = '500-357561-277 (AUD)';
        currencyLabel['CNY'] = '500-357561-285 (CNY)';
        currencyLabel['JPY'] = '500-357561-278 (JPY)';
        currencyLabel['GBP'] = '500-357561-276 (GBP)';
        currencyLabel['SGD'] = '500-357561-280 (SGD)';
        currencyLabel['CHF'] = '500-357561-281 (CHF)';
        currencyLabel['MYR'] = '301-753257-102 (MYR)';
        if(cur == 'USD'){
            $('.normaCurArea').hide();
            $('.usdCurArea').show();
        }else{
            $('.normaCurArea').show();
            $('.usdCurArea').hide();
        }

        $('.dynamicAcctNo').text(currencyLabel[cur]);
    }

    var loadinstallFx = function() {

        loadinstallFx.prototype.initBehavior = function() {


            $('body').on('keydown', '#field_amount', function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110,190])||/65|67|86|88/.test(e.keyCode)&&(!0===e.ctrlKey||!0===e.metaKey)||35<=e.keyCode&&40>=e.keyCode||(e.shiftKey||48>e.keyCode||57<e.keyCode)&&(96>e.keyCode||105<e.keyCode)&&e.preventDefault()});

            window.nls = {
                otperror:'Invalid OTP. Please try again',
            nextstep: 'Next',
            success: 'Completion',
            desc: 'Ref. No',
            fail: 'Fail',
            failmsg: 'The instruction has NOT been received. Please contact our staff.',
            done: 'Success',
            plsfillpwd: 'Please enter OTP',
            loginacctfirst: 'Please login first.',
            fillindata: 'Please enter ',
            choosedata: 'Please choose ',
            localbank: 'Local Bank',
            overseabank: 'Overseas Bank',
            transfer: 'Transfer',
            cheuqe: 'Cheque',
                telex: 'T/T',
                Custodian: 'Cash Account',
                Margin: 'Margin',
            deposit: 'Deposit',
            withdraw: 'Withdraw',
            transacct: 'Account Type',
                transmethod: 'Settle Method',
            amount: 'Amount',
            amounterror: 'Amount cannot be less than zero',
            currency: 'Currency',
            remark: 'Remark',
                cashfrom: 'Withdraw to',
                bankname: 'Bank Name',
                bankaccountname: 'Customer Name',
                bankaccountnum: 'Bank Account Number',
                bankcode: 'Bank / Swift Code'
            };







            window.glootperror = false;
            window.glostepback = 1;
            window.glostepgo = 2;
            window.instFormData = {};
            window.instSettlementForm = {};
            instFormData.Instruction = 'D';
        // window.debuggermode = true;
        window.debuggermode = false;
            
            handlestepcolor(1);


            window.glo = {}
            glo.isloginflag = false;
            glo.sessionid = "";
            glo.sessionid = "@{S:SESSIONID}";
            glo.clientid = "@{S:CLIENTID}";
            var transacctlst = '@{S:TRADINGACCLIST}';

            // glo.sessionid = '';
            // glo.clientid = '';
            // transacctlst = '';

            transacctlst != "" && (glo.tranaccseq = JSON.parse(transacctlst));

            glo.locallang =convtoi18n("@{S:LANG}","@{S:CULTURE}");

            var haveMType = false;
            $('.marginchoice').hide();
            if (glo.tranaccseq && glo.tranaccseq != null && glo.tranaccseq != undefined && glo.tranaccseq.length > 0) {
                for (var i = 0; i < glo.tranaccseq.length; i++) {
                    if (glo.tranaccseq[i].accountType == "M") {
                        haveMType = true;
                    }
                }
            }

            haveMType == true && $('.marginchoice').show();

            $('#stepback').on('click', function(e) {
                var selpage = glostepback;
                loadstep(selpage);
            });

            $('#stepgo').on('click', function(e) {
                var selpage = glostepgo;
                loadstep(selpage);
            });

            $('.confirmpage').hide();
            $('.completepage').hide();



            // init
            $(".inst-area-one").show();
            $(".inst-area-two").hide();
            $(".inst-area-three").show();
            $(".inst-area-four").hide();
            $(".inst-area-five").hide();
            $(".inst-area-six").show();
            $(".inst-area-seven").show();
            $(".depositTitle").show();
            $(".withdrawTitle").hide();
            $(".inst-tips").hide();
            
            $('.instdetailsinfo').hide();
            $('.normaCurArea').hide();
            $('.usdCurArea').hide();
            $('#remarkarea').trigger('autoresize');
            $('#field_currency').on('change',function(e){
            $('.instdetailsinfo').show();
                var selcur = $(this).val();
                loadtipsforCur(selcur);                
            });

            $('.cashTradingBtn').on('click', function(e) {

                var curSelItem = $(this).data().tradtype;
                $('.cashTradingBtn').removeClass('cashTradingActive');
                $(this).addClass('cashTradingActive');
                if (curSelItem == 'depositItem') {
                    instFormData.Instruction = 'D';
                    $(".inst-area-one").show();
                    $(".inst-area-two").hide();
                    $(".inst-area-three").show();
                    $(".inst-area-four").hide();
                    $(".inst-area-five").hide();
                    $(".inst-area-six").show();
                    $(".inst-area-seven").show();
                    $(".depositTitle").show();
                    $(".withdrawTitle").hide();
                    $(".inst-tips").hide();
                    $('.clientdataTitle').show();
                    $('.inst-area-clientarea').show();


                } else {
                    instFormData.Instruction = 'W';
                    $(".inst-area-one").show();
                    $(".inst-area-two").show();
                    $(".inst-area-three").show();
                    $(".inst-area-four").show();
                    $(".inst-area-five").show();
                    $(".inst-area-six").hide();
                    $(".inst-area-seven").hide();
                    $(".depositTitle").hide();
                    $(".withdrawTitle").show();
                    $(".inst-tips").show();
                    $('.clientdataTitle').hide();
                    $('.inst-area-clientarea').hide();
                }
            });


            $('.settlemethodItem').on('click', function(e) {
                var curSelItem = $(this).data().settleitem;
                $('.transfertoAcct').addClass('hidden');
                if (curSelItem == 'transfer') {
                    $('.transfertoAcct').removeClass('hidden');
                }
            });


        }

    }
    var init = new loadinstallFx();
    init.initBehavior();

});
</script>